pipeline {
    agent any
    environment {
        OWNER="lexedwards"
        REPO="testpkg"
        COMMIT_MESSAGE = sh(script: "git log -1 --pretty=%B",,returnStdout: true).trim()
    }
    stages {
        stage("Variables") {
            steps {
                sh "printenv"
            }
        }
        stage("Version Check") {
            steps {
                sh "node --version"
                sh "npm --version"
                sh "git --version"
            }
        }
        stage("Lint commit") {
            steps {
                sh "npx @lexedwards/release-cli lint '$COMMIT_MESSAGE'"
            }
        }
        stage('Publish') {
            environment {
                NPM_TOKEN=credentials('NPM_TOKEN')
                GITHUB_TOKEN=credentials('GITHUB_TOKEN')
            }
            steps {

            }
        }
    }
}